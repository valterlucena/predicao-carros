---
title: "Predicao de pre√ßos de Carros"
author: "A equipe"
date: "5 de dezembro de 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r setup, warning=FALSE, message=FALSE}
library(tidyverse)
library(here)
library(caret)
library(elasticnet)
library(RSNNS)

theme_set(theme_minimal())
```


```{r, warning=FALSE, message=FALSE}
treino <- read.csv(here("data/treino.csv"), encoding = "latin1")
validacao <- read.csv(here("data/validacao.csv"), encoding = "latin1")
```


```{r}
treino %>% 
  names()
```

```{r}
treino %>% 
  head()
```

```{r}
set.seed(379)

amostra <- treino[sample(nrow(treino), 5000), ]
```



```{r}
amostra$Year <- as.factor(fa(amostra$Year))
amostra$City <- as.factor(amostra$City)
amostra$State <- as.factor(amostra$State)
amostra$Model <- as.factor(amostra$Model)
amostra$Make <- as.factor(amostra$Make)
```


```{r}
controle <- trainControl(method = "repeatedcv",
                   number = 5,
                   repeats = 10,
                   verboseIter = TRUE)
```

```{r}
preProcessamento <- c("scale", "center", "nzv")
```

```{r}
modelo.ridge <- train(Price ~ .,
                      data = amostra,
                      trControl = controle,
                      preProcess = preProcessamento,
                      method = "ridge")
saveRDS(modelo.ridge, "ridge.rds")
```

```{r}
modelo.ridge <- readRDS(file="ridge.rds")
modelo.ridge
```


```{r}
modelo.knn <- train(Price ~.,
                    data = amostra,
                    trControl = controle,
                    preProcess = preProcessamento,
                    method = "knn")
saveRDS(modelo.knn, "knn.rds")
```

```{r}
modelo.knn <- readRDS(file="knn.rds")
modelo.knn
```

```{r}
removeNaoAlfanumericos <- function(x) str_replace_all(x, "[^[:alnum:]]", "")
```

```{r}
amostra$City <- removeNaoAlfanumericos(amostra$City)
amostra$State <- removeNaoAlfanumericos(amostra$State)
amostra$Model <- removeNaoAlfanumericos(amostra$Model)
amostra$Make <- removeNaoAlfanumericos(amostra$Make)
```

```{r}
modelo.mlp <- caret::train(Price ~ .,
                    data = amostra,
                    trControl = controle,
                    preProcess = preProcessamento,
                    method = "mlp")
saveRDS(modelo.mlp, "mlp.rds")
```

```{r}
modelo.mlp <- readRDS(file="mlp.rds")
modelo.mlp
```
